<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#" lang="en">
  <head>
    <title>passport-delivery.com</title>
    <meta charset="utf-8">
    <meta name="description" content="OAuth 2.0 client module for delivery.com">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="canonical" href="http://www.passportjs.org/packages/passport-delivery.com/">
    <link rel="manifest" href="/manifest.webmanifest"/>
    <meta name="theme-color" content="#35DF79"/>
    <link rel="shortcut icon" href="/images/favicon/favicon.ico"/>
    <link rel="icon" sizes="16x16" type="image/png" href="/images/favicon/favicon-16x16.png"/>
    <link rel="icon" sizes="32x32" type="image/png" href="/images/favicon/favicon-32x32.png"/>
    <link rel="icon" sizes="36x36" type="image/png" href="/images/favicon/android-icon-36x36.png"/>
    <link rel="icon" sizes="48x48" type="image/png" href="/images/favicon/android-icon-48x48.png"/>
    <link rel="icon" sizes="70x70" type="image/png" href="/images/favicon/ms-icon-70x70.png"/>
    <link rel="icon" sizes="72x72" type="image/png" href="/images/favicon/android-icon-72x72.png"/>
    <link rel="icon" sizes="96x96" type="image/png" href="/images/favicon/android-icon-96x96.png"/>
    <link rel="icon" sizes="144x144" type="image/png" href="/images/favicon/ms-icon-144x144.png"/>
    <link rel="icon" sizes="150x150" type="image/png" href="/images/favicon/ms-icon-150x150.png"/>
    <link rel="icon" sizes="192x192" type="image/png" href="/images/favicon/android-icon-192x192.png"/>
    <link rel="icon" sizes="310x310" type="image/png" href="/images/favicon/ms-icon-310x310.png"/>
    <link rel="apple-touch-icon" href="/images/favicon/apple-icon-57x57.png"/>
    <link rel="apple-touch-icon" sizes="60x60" href="/images/favicon/apple-icon-60x60.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="/images/favicon/apple-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="76x76" href="/images/favicon/apple-icon-76x76.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="/images/favicon/apple-icon-114x114.png"/>
    <link rel="apple-touch-icon" sizes="120x120" href="/images/favicon/apple-icon-120x120.png"/>
    <link rel="apple-touch-icon" sizes="144x144" href="/images/favicon/apple-icon-144x144.png"/>
    <link rel="apple-touch-icon" sizes="152x152" href="/images/favicon/apple-icon-152x152.png"/>
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-icon-180x180.png"/>
    <meta name="msapplication-config" content="/browserconfig.xml"/>
    <meta name="msapplication-TileColor" content="#35DF79"/>
    <meta name="msapplication-TileImage" content="/images/favicon/ms-icon-144x144.png"/>
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="passport-delivery.com"/>
    <meta property="og:description" content="OAuth 2.0 client module for delivery.com"/>
    <meta property="og:url" content="http://www.passportjs.org/packages/passport-delivery.com/"/>
    <meta property="og:image" content="http://www.passportjs.org/images/facebook-card.png"/>
    <meta property="og:image:type" content="image/png"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>
    <meta property="og:site_name" content="Passport.js"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@passportjs"/>
    <meta name="twitter:title" content="passport-delivery.com"/>
    <meta name="twitter:description" content="OAuth 2.0 client module for delivery.com"/>
    <meta name="twitter:image" content="http://www.passportjs.org/images/twitter-card.png"/>
    <meta name="flattr:id" content="d5znvd"/>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-73332146-2', 'auto');
      ga('send', 'pageview');
    </script>
    <link type="text/css" rel="stylesheet" href="http://fast.fonts.net/cssapi/7527d73a-ebfe-45db-a201-ff2812df4b18.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/default.min.css">
    <link rel="stylesheet" href="/assets/styles/all.css">
    <script data-main="/script/main" src="//cdnjs.cloudflare.com/ajax/libs/require.js/2.3.5/require.js"></script>
  </head>
  <body>
    <div id="container"><span id="top"></span>
      <div id="toolbar">
        <div class="toolbar-search">
          <form action="/search">
            <button type="submit"></button>
            <input type="text" name="q" placeholder="Search for Strategies">
          </form>
        </div>
        <div class="toolbar-social">
          <ul>
            <li class="facebook"><a href="https://www.facebook.com/passportjs" target="_blank"></a></li>
            <li class="twitter"><a href="https://twitter.com/passportjs" target="_blank"></a></li>
            <li class="github"><a href="https://github.com/jaredhanson/passport" target="_blank"><span class="count">0</span></a></li>
          </ul>
        </div>
      </div>
      <nav id="menu"><a class="menu-logo" href="/" title="Passport.js"></a>
        <div class="menu-trigger"><span></span></div>
        <div class="menu-items">
          <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/docs/">Documentation</a></li>
            <li><a href="/features/">Features</a></li>
            <li><a href="/packages/">Strategies</a></li>
          </ul><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=passportjsorg" id="_carbonads_js"></script>
        </div><a class="supported" href="http://auth0.com" target="_blank">Supported by<i class="auth0"></i></a>
      </nav>
      <div id="content">
        <div class="package hproduct" id="package">
          <div class="description"><h1 id="passport-delivery-com-oauth">Passport-Delivery.com-OAuth</h1>
<p><a href="http://passportjs.org/">Passport</a> strategies for authenticating with <a href="https://www.delivery.com/">Delivery.com</a> using OAuth 2.0</p>
<p>This module lets you authenticate using Delivery.com in your Node.js applications.
By plugging into Passport, Delivery.com authentication can be easily and unovtrusively  integrated into any application or framework that supports <a href="http://senchalabs.org/connect/">Connect</a>-style middleware, including <a href="http://expressjs.com/">Express</a>.</p>
<h2 id="intall">Intall</h2>
<pre><code><span class="meta">$</span><span class="bash"> npm install passport-delivery.com</span>
</code></pre><h2 id="usage-of-oauth-2-0">Usage of OAuth 2.0</h2>
<h4 id="configure-strategy">Configure Strategy</h4>
<p>The Delivery.com OAuth 2.0 authentication strategy authenicates users using a Delivery.com
account and OAuth 2.0 tokens. The strategy requires a <code>verify</code> callback, which accepts those credentials
and calls <code>done</code> providing a user, as well as <code>options</code> specifying a <code>clientID</code>, <code>clientSecret</code>, and <code>callbackURL</code>.</p>
<pre><code><span class="keyword">var</span> DeliveryStrategy = <span class="keyword">require</span>(<span class="string">'passport-delivery.com'</span>).Strategy;

passport.<span class="keyword">use</span>(<span class="keyword">new</span> DeliveryStrategy({
  clientID: Delivery_CLIENT_ID,
  clientSecret: Delivery_CLIENT_SECRET,
  callbackURL: <span class="string">'http://127.0.0.1:3000/auth/delivery/callback'</span>
  },
  <span class="function"><span class="keyword">function</span><span class="params">(accessToken, refreshToken, profile, done)</span> </span>{
    User.findOrCreate({ accessToken: accessToken }, <span class="function"><span class="keyword">function</span> <span class="params">(err, user)</span> </span>{
      <span class="keyword">return</span> done(err, user);
    });
  }
));

<span class="comment">// If you are using MongoDB take a look at the below function</span>

passport.<span class="keyword">use</span>(<span class="keyword">new</span> DeliveryStrategy({
  clientID: Delivery_CLIENT_ID,
  clientSecret: Delivery_CLIENT_SECRET,
  callbackURL: <span class="string">'http://127.0.0.1:3000/auth/delivery/callback'</span>
  },
  <span class="function"><span class="keyword">function</span><span class="params">(accessToken, refreshToken, profile, done)</span> </span>{
    User.findOne({ accessToken: accessToken }, <span class="function"><span class="keyword">function</span><span class="params">(err, user)</span></span>{
      <span class="keyword">if</span>(err) <span class="keyword">return</span> err;
      <span class="keyword">if</span>(!user){
        <span class="keyword">var</span> u = <span class="keyword">new</span> User({
          accessToken: accessToken
        });
        u.save(<span class="function"><span class="keyword">function</span><span class="params">(err)</span></span>{
          <span class="keyword">return</span> done(err, u);
        });
      } <span class="keyword">else</span>{
        user.save(<span class="function"><span class="keyword">function</span><span class="params">(err)</span></span>{
          <span class="keyword">return</span> done(err, user);
        });
      }
    });
  }
));
</code></pre><h4 id="important-the-profile-object">Important: The <code>profile</code> Object</h4>
<p>Currently, Delivery.com does not support further queries to obtain personal information (fullName, userName, email) on the user via the conventional /v1/me endpoint. The <code>profile</code> object returned above is empty. The strategy will be updated to include personal information if Delivery.com updates their API to support to retrive user information. Actions can be made on behalf of the user in session by making queries with the accessToken in the Authorization HTTP header.</p>
<pre><code><span class="selector-tag">res</span><span class="selector-class">.setHeader</span>(<span class="string">'access_token'</span>, <span class="string">'&lt;access_token goes here&gt;'</span>);
</code></pre><h4 id="authenticate-requests">Authenticate Requests</h4>
<p>Use <code>passport.authenticate()</code>, specifying the <code>&#39;delivery&#39;</code> strategy, to authenticate requests.</p>
<p>For example, as route middleware in an <a href="http://expressjs.com/">Express</a>
application:</p>
<pre><code>app.get('/auth/delivery', function(req, res, next){
  req.session.<span class="keyword">state</span> = crypto.<span class="keyword">random</span>Bytes(<span class="number">32</span>).<span class="keyword">to</span>String('hex');
  passport.authenticate('delivery', {
    <span class="keyword">state</span>: req.session.<span class="keyword">state</span>
  })(req, res, next);
  }, users.signin);

app.get('/auth/delivery/callback', 
  passport.authenticate('delivery', { failureRedirect: '/login'}), 
  function(req, res) {
    // Successful authentication, redirect home.
    res.redirect('/');
  });
</code></pre><h2 id="examples">Examples</h2>
<ul>
<li>Coming soon</li>
</ul>
<h2 id="credits">Credits</h2>
<ul>
<li><a href="http://github.com/jihokoo">Ji Ho Koo</a></li>
</ul>
<h2 id="thanks">Thanks</h2>
<ul>
<li><a href="https://github.com/jaredhanson">Jared Hanson</a></li>
</ul>
<h2 id="license">License</h2>
<p><a href="http://opensource.org/licenses/MIT">The MIT License</a></p>
<p>Copyright (c) 2014-2015</p>
</div>
          <div class="metadata">
            <div class="install"><code>npm install <span class="fn">passport-delivery.com</span></code></div>
            <ul>
              <li><span class="version">0.0.3</span> published <abbr class="updated" title="2014-05-04T04:06:44Z">4 years ago</abbr></li>
              <li><a class="url" href="git://github.com/jihokoo/passport-delivery.com.git">https://github.com/jihokoo/passport-delivery.com</a></li>
              <li><a rel="licence"></a></li>
            </ul>
            <ul>
              <li><b>0</b> downloads in the last day</li>
              <li><b>0</b> downloads in the last week</li>
              <li><b>30</b> downloads in the last month</li>
            </ul>
          </div>
        </div><a class="supported" href="http://auth0.com" target="_blank">Supported by<i class="auth0"></i></a>
      </div>
    </div>
    <div class="search-con">
      <div class="head"><span class="close-ico"></span>
        <div class="hold">
          <h2>SEARCH FOR STRATEGIES</h2>
          <form action="/">
            <input value="" type="text" name="strategy" placeholder="Start typing" autocomplete="off">
          </form>
          <p class="info-line"><span>0</span>STRATEGIES</p>
        </div>
      </div>
      <div class="results">
        <section></section>
      </div>
    </div>
    <!-- Google Tag Manager-->
    <noscript>iframe(src='//www.googletagmanager.com/ns.html?id=GTM-M5S3PH', height='0', width='0', style='display:none;visibility:hidden')</noscript>
    <script>
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-M5S3PH');
    </script>
    <!-- End Google Tag Manager-->
  </body>
</html>