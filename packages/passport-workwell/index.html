<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#" lang="en">
  <head>
    <title>passport-workwell</title>
    <meta charset="utf-8">
    <meta name="description" content="Passport for Workwell">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="canonical" href="http://www.passportjs.org/packages/passport-workwell/">
    <link rel="manifest" href="/manifest.webmanifest"/>
    <meta name="theme-color" content="#35DF79"/>
    <link rel="shortcut icon" href="/images/favicon/favicon.ico"/>
    <link rel="icon" sizes="16x16" type="image/png" href="/images/favicon/favicon-16x16.png"/>
    <link rel="icon" sizes="32x32" type="image/png" href="/images/favicon/favicon-32x32.png"/>
    <link rel="icon" sizes="36x36" type="image/png" href="/images/favicon/android-icon-36x36.png"/>
    <link rel="icon" sizes="48x48" type="image/png" href="/images/favicon/android-icon-48x48.png"/>
    <link rel="icon" sizes="70x70" type="image/png" href="/images/favicon/ms-icon-70x70.png"/>
    <link rel="icon" sizes="72x72" type="image/png" href="/images/favicon/android-icon-72x72.png"/>
    <link rel="icon" sizes="96x96" type="image/png" href="/images/favicon/android-icon-96x96.png"/>
    <link rel="icon" sizes="144x144" type="image/png" href="/images/favicon/ms-icon-144x144.png"/>
    <link rel="icon" sizes="150x150" type="image/png" href="/images/favicon/ms-icon-150x150.png"/>
    <link rel="icon" sizes="192x192" type="image/png" href="/images/favicon/android-icon-192x192.png"/>
    <link rel="icon" sizes="310x310" type="image/png" href="/images/favicon/ms-icon-310x310.png"/>
    <link rel="apple-touch-icon" href="/images/favicon/apple-icon-57x57.png"/>
    <link rel="apple-touch-icon" sizes="60x60" href="/images/favicon/apple-icon-60x60.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="/images/favicon/apple-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="76x76" href="/images/favicon/apple-icon-76x76.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="/images/favicon/apple-icon-114x114.png"/>
    <link rel="apple-touch-icon" sizes="120x120" href="/images/favicon/apple-icon-120x120.png"/>
    <link rel="apple-touch-icon" sizes="144x144" href="/images/favicon/apple-icon-144x144.png"/>
    <link rel="apple-touch-icon" sizes="152x152" href="/images/favicon/apple-icon-152x152.png"/>
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-icon-180x180.png"/>
    <meta name="msapplication-config" content="/browserconfig.xml"/>
    <meta name="msapplication-TileColor" content="#35DF79"/>
    <meta name="msapplication-TileImage" content="/images/favicon/ms-icon-144x144.png"/>
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="passport-workwell"/>
    <meta property="og:description" content="Passport for Workwell"/>
    <meta property="og:url" content="http://www.passportjs.org/packages/passport-workwell/"/>
    <meta property="og:image" content="http://www.passportjs.org/images/facebook-card.png"/>
    <meta property="og:image:type" content="image/png"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>
    <meta property="og:site_name" content="Passport.js"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@passportjs"/>
    <meta name="twitter:title" content="passport-workwell"/>
    <meta name="twitter:description" content="Passport for Workwell"/>
    <meta name="twitter:image" content="http://www.passportjs.org/images/twitter-card.png"/>
    <meta name="flattr:id" content="d5znvd">
    <link type="text/css" rel="stylesheet" href="http://fast.fonts.net/cssapi/7527d73a-ebfe-45db-a201-ff2812df4b18.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/default.min.css">
    <link rel="stylesheet" href="/assets/styles/all.css">
    <script data-main="/script/main" src="//cdnjs.cloudflare.com/ajax/libs/require.js/2.3.5/require.js"></script>
  </head>
  <body>
    <div id="container"><span id="top"></span>
      <div id="toolbar">
        <div class="search">
          <form action="/search">
            <button type="submit"></button>
            <input type="text" name="q" placeholder="Search for Strategies">
          </form>
        </div>
        <div class="social">
          <ul>
            <li class="facebook"><a href="https://www.facebook.com/passportjs" target="_blank"></a></li>
            <li class="twitter"><a href="https://twitter.com/passportjs" target="_blank"></a></li>
            <li class="github"><a href="https://github.com/jaredhanson/passport" target="_blank"><span class="count">0</span></a></li>
          </ul>
        </div>
      </div>
      <nav id="menu"><a class="logo" id="logo" href="/" title="JH"></a><a class="jared" href="http://twitter.com/jaredhanson" target="_blank">by Jared Hanson</a>
        <div class="menu-trigger"><span></span></div>
        <div class="menu-items">
          <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/docs/">Documentation</a></li>
            <li><a href="/features/">Features</a></li>
            <li><a href="/packages/">Strategies</a></li>
          </ul><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=passportjsorg" id="_carbonads_js"></script>
        </div><a class="supported" href="http://auth0.com" target="_blank">Supported by<i class="auth0"></i></a>
      </nav>
      <div id="content">
        <div class="package hproduct" id="package">
          <div class="description"><p>A simple <a href="http://passportjs.org/">Passport</a> strategy for Workwell.</p>
<h2 id="install">Install</h2>
<p>  npm install passport-workwell</p>
<h2 id="usage">Usage</h2>
<p>Register the strategy in your passport.js file</p>
<pre><code class="lang-javascript"><span class="keyword">var</span> WorkwellStrategy = <span class="built_in">require</span>(<span class="string">'passport-workwell'</span>).Strategy;

passport.use(<span class="keyword">new</span> WorkwellStrategy({
  <span class="attr">clientID</span>: WORKWELL_SERVICE_ID,
  <span class="attr">clientSecret</span>: WORKWELL_SERVICE_SECRET,
  <span class="attr">getProfilePage</span>: <span class="string">'url of your web page to get the workwell profile (see below)'</span>,
  <span class="attr">passReqToCallback</span>: <span class="literal">true</span>
}, <span class="function"><span class="keyword">function</span>(<span class="params">req, serviceToken, profile, done</span>) </span>{
  <span class="comment">// asynchronous verification, for effect...</span>
  process.nextTick(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{
    <span class="comment">// To keep the example simple, the user's Workwell profile is returned to</span>
    <span class="comment">// represent the logged-in user. In a typical application, you would want</span>
    <span class="comment">// to associate the Workwell account with a user record in your database,</span>
    <span class="comment">// and return that user instead.</span>
    <span class="keyword">return</span> done(<span class="literal">null</span>, profile);
  });
}));
</code></pre>
<p>and then authenticate as:</p>
<pre><code class="lang-javascript">app.get(<span class="string">'/auth/workwell'</span>,
  passport.authenticate(<span class="string">'workwell'</span>, { <span class="attr">state</span>: <span class="string">'SOME STATE'</span>  }),
  <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>{
    <span class="comment">// The request will be redirected to Workwell for authentication, so this</span>
    <span class="comment">// function will not be called.</span>
  });
</code></pre>
<p>the login callback:</p>
<pre><code class="lang-javascript">app.get(<span class="string">'/auth/workwell/callback'</span>, 
    passport.authenticate(<span class="string">'workwell'</span>, {
        <span class="attr">successRedirect</span>: <span class="string">'/'</span>,
        <span class="attr">failureRedirect</span>: <span class="string">'/login'</span>
    })
);
</code></pre>
<p>Copy the workwell.js file of your /node_modules/passport-workwell/node_modules/workwell/dist/js/ folder into the javascript folder of your project (used by the web client application)</p>
<p>You need to create a page to get the Workwell profile using the Workwell mobile bridge. Report the URL of this page in the <em>getProfilePage</em> option
This page will be called with servicetoken get parameter : mypagetogetprofile.html?servicetoken=12345678910. You need to assign the service token parameter to the serviceToken javascript variable.
Depending on the web framework you use, you will find many scripts to parse the URL to get this parameter.</p>
<pre><code class="lang-html"><span class="tag">&lt;<span class="name">html</span>&gt;</span>
<span class="tag">&lt;<span class="name">head</span>&gt;</span>
    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">'path/to/javascript/folder/of/your/project/workwell.js'</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>
<span class="tag">&lt;/<span class="name">head</span>&gt;</span>
<span class="tag">&lt;<span class="name">body</span>&gt;</span>
    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript">
        <span class="keyword">var</span> serviceToken = yourFunctionToGetTheServiceTokenGetParameter();
        Workwell.setServiceToken(serviceToken);
        Workwell.getUserInfo({
            <span class="attr">success</span>: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>{
                <span class="keyword">if</span> (data &amp;&amp; data.user &amp;&amp; data.user.email) {
                    <span class="keyword">var</span> email = data.user.email;
                    <span class="keyword">var</span> name = data.user.name ? data.user.name : data.user.email;
                    $<span class="built_in">window</span>.location.href = <span class="string">"/api/auth/workwell/callback?servicetoken="</span> + serviceToken + <span class="string">"&amp;email="</span> + email + <span class="string">"&amp;name="</span> + name;
                } <span class="keyword">else</span> {
                    alert(<span class="string">"Technical issue, unable to get your Workwell profile. Please try later !"</span>);
                }
            },
            <span class="attr">error</span>: <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>{
                alert(<span class="string">"Technical issue, unable to get your Workwell profile. Please try later !"</span>);
            }
        });
    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>
<span class="tag">&lt;/<span class="name">body</span>&gt;</span>
<span class="tag">&lt;/<span class="name">html</span>&gt;</span>
</code></pre>
<p>See <a href="https://workwell.api-docs.io">this</a> for details on Workwell API.</p>
<h2 id="author">Author</h2>
<p>Kimind (<a href="http://www.kimind.com">http://www.kimind.com</a>)</p>
<h2 id="license">License</h2>
<p>This project is licensed under the MIT license. See the <a href="LICENSE">LICENSE</a> file for more info.</p>
</div>
          <div class="metadata">
            <div class="install"><code>npm install <span class="fn">passport-workwell</span></code></div>
            <ul>
              <li><span class="version">1.0.1</span> published <abbr class="updated" title="2017-11-06T08:39:11Z">3 months ago</abbr></li>
              <li><a class="url" href="git://github.com/emathieu13/passport-workwell.git">https://github.com/emathieu13/passport-workwell</a></li>
              <li><a rel="licence" href="http://www.opensource.org/licenses/MIT">MIT License</a></li>
            </ul>
            <ul>
              <li><b>0</b> downloads in the last day</li>
              <li><b>1</b> downloads in the last week</li>
              <li><b>24</b> downloads in the last month</li>
            </ul>
          </div>
        </div><a class="supported" href="http://auth0.com" target="_blank">Supported by<i class="auth0"></i></a>
      </div>
    </div>
    <div class="search-con">
      <div class="head"><span class="close-ico"></span>
        <div class="hold">
          <h2>SEARCH FOR STRATEGIES</h2>
          <form action="/">
            <input value="" type="text" name="strategy" placeholder="Start typing" autocomplete="off">
          </form>
          <p class="info-line"><span>0</span>STRATEGIES</p>
        </div>
      </div>
      <div class="results">
        <section></section>
      </div>
    </div>
    <script>
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-104798-10']);
      _gaq.push(['_trackPageview']);
      
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
      
    </script>
    <!-- Google Tag Manager-->
    <noscript>iframe(src='//www.googletagmanager.com/ns.html?id=GTM-M5S3PH', height='0', width='0', style='display:none;visibility:hidden')</noscript>
    <script>
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-M5S3PH');
    </script>
    <!-- End Google Tag Manager-->
  </body>
</html>