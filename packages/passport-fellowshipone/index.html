<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#" lang="en">
  <head>
    <title>passport-fellowshipone</title>
    <meta charset="utf-8">
    <meta name="description" content="Fellowship One (F1) authentication strategy for Passport.">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="canonical" href="http://www.passportjs.org/packages/passport-fellowshipone/">
    <link rel="manifest" href="/manifest.webmanifest"/>
    <meta name="theme-color" content="#35DF79"/>
    <link rel="shortcut icon" href="/images/favicon/favicon.ico"/>
    <link rel="icon" sizes="16x16" type="image/png" href="/images/favicon/favicon-16x16.png"/>
    <link rel="icon" sizes="32x32" type="image/png" href="/images/favicon/favicon-32x32.png"/>
    <link rel="icon" sizes="36x36" type="image/png" href="/images/favicon/android-icon-36x36.png"/>
    <link rel="icon" sizes="48x48" type="image/png" href="/images/favicon/android-icon-48x48.png"/>
    <link rel="icon" sizes="70x70" type="image/png" href="/images/favicon/ms-icon-70x70.png"/>
    <link rel="icon" sizes="72x72" type="image/png" href="/images/favicon/android-icon-72x72.png"/>
    <link rel="icon" sizes="96x96" type="image/png" href="/images/favicon/android-icon-96x96.png"/>
    <link rel="icon" sizes="144x144" type="image/png" href="/images/favicon/ms-icon-144x144.png"/>
    <link rel="icon" sizes="150x150" type="image/png" href="/images/favicon/ms-icon-150x150.png"/>
    <link rel="icon" sizes="192x192" type="image/png" href="/images/favicon/android-icon-192x192.png"/>
    <link rel="icon" sizes="310x310" type="image/png" href="/images/favicon/ms-icon-310x310.png"/>
    <link rel="apple-touch-icon" href="/images/favicon/apple-icon-57x57.png"/>
    <link rel="apple-touch-icon" sizes="60x60" href="/images/favicon/apple-icon-60x60.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="/images/favicon/apple-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="76x76" href="/images/favicon/apple-icon-76x76.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="/images/favicon/apple-icon-114x114.png"/>
    <link rel="apple-touch-icon" sizes="120x120" href="/images/favicon/apple-icon-120x120.png"/>
    <link rel="apple-touch-icon" sizes="144x144" href="/images/favicon/apple-icon-144x144.png"/>
    <link rel="apple-touch-icon" sizes="152x152" href="/images/favicon/apple-icon-152x152.png"/>
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-icon-180x180.png"/>
    <meta name="msapplication-config" content="/browserconfig.xml"/>
    <meta name="msapplication-TileColor" content="#35DF79"/>
    <meta name="msapplication-TileImage" content="/images/favicon/ms-icon-144x144.png"/>
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="passport-fellowshipone"/>
    <meta property="og:description" content="Fellowship One (F1) authentication strategy for Passport."/>
    <meta property="og:url" content="http://www.passportjs.org/packages/passport-fellowshipone/"/>
    <meta property="og:image" content="http://www.passportjs.org/images/facebook-card.png"/>
    <meta property="og:image:type" content="image/png"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>
    <meta property="og:site_name" content="Passport.js"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@passportjs"/>
    <meta name="twitter:title" content="passport-fellowshipone"/>
    <meta name="twitter:description" content="Fellowship One (F1) authentication strategy for Passport."/>
    <meta name="twitter:image" content="http://www.passportjs.org/images/twitter-card.png"/>
    <meta name="flattr:id" content="d5znvd"/>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-73332146-2', 'auto');
      ga('send', 'pageview');
    </script>
    <!--+google-tag-manager('GTM-M5S3PH')-->
    <!--link(type='text/css', rel='stylesheet', href='http://fast.fonts.net/cssapi/7527d73a-ebfe-45db-a201-ff2812df4b18.css')-->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/default.min.css">
    <link rel="stylesheet" href="/assets/styles/all.css">
    <script data-main="/script/main" src="//cdnjs.cloudflare.com/ajax/libs/require.js/2.3.5/require.js"></script>
  </head>
  <body>
    <div id="container"><span id="top"></span>
      <div id="toolbar">
        <div class="toolbar-search">
          <form action="/search">
            <button type="submit"></button>
            <input type="text" name="q" placeholder="Search for Strategies">
          </form>
        </div>
        <div class="toolbar-social">
          <ul>
            <li class="facebook"><a href="https://www.facebook.com/passportjs" target="_blank"></a></li>
            <li class="twitter"><a href="https://twitter.com/passportjs" target="_blank"></a></li>
            <li class="github"><a href="https://github.com/jaredhanson/passport" target="_blank"><span class="count">0</span></a></li>
          </ul>
        </div>
      </div>
      <nav id="menu"><a class="menu-logo" href="/" title="Passport.js"></a>
        <div class="menu-trigger"><span></span></div>
        <div class="menu-items">
          <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/docs/">Documentation</a></li>
            <li><a href="/features/">Features</a></li>
            <li><a href="/packages/">Strategies</a></li>
          </ul><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=passportjsorg" id="_carbonads_js"></script>
        </div>
      </nav>
      <div id="content">
        <div class="package hproduct" id="package">
          <div class="description"><p><a href="https://travis-ci.org/hairyhenderson/passport-fellowshipone"><img src="https://img.shields.io/travis/hairyhenderson/passport-fellowshipone.svg?style=flat" alt="Build Status"></a>
<a href="https://codeclimate.com/github/hairyhenderson/passport-fellowshipone"><img src="https://img.shields.io/codeclimate/coverage/github/hairyhenderson/passport-fellowshipone.svg?style=flat" alt="Code Coverage"></a>
<a href="https://codeclimate.com/github/hairyhenderson/passport-fellowshipone"><img src="https://img.shields.io/codeclimate/github/hairyhenderson/passport-fellowshipone.svg?style=flat" alt="Code Climate"></a>
<a href="https://gemnasium.com/hairyhenderson/passport-fellowshipone"><img src="https://img.shields.io/gemnasium/hairyhenderson/passport-fellowshipone.svg?style=flat" alt="Dependency Status"></a>
<a href="https://npmjs.org/package/passport-fellowshipone"><img src="https://img.shields.io/npm/v/passport-fellowshipone.svg?style=flat" alt="Current Version"></a></p>
<h1 id="passport-fellowshipone">Passport-FellowshipOne</h1>
<p><a href="http://passportjs.org/">Passport</a> strategy for authenticating with <a href="http://developer.fellowshipone.org">Fellowship One</a> using the OAuth 1.0a API.</p>
<p>This module lets you authenticate using Fellowship One in your Node.js applications. By plugging into Passport, Fellowship One authentication can be easily and unobtrusively integrated into any application or framework that supports <a href="http://www.senchalabs.org/connect/">Connect</a>-style middleware, including <a href="http://expressjs.com/">Express</a>.</p>
<h2 id="install">Install</h2>
<pre><code>$ npm install pass<span class="keyword">port</span>-fellowshipone
</code></pre><h2 id="usage">Usage</h2>
<h4 id="configure-strategy">Configure Strategy</h4>
<p>The Fellowship One authentication strategy authenticates users using a Fellowship One account and OAuth 1.0a tokens. The strategy requires a <code>verify</code> callback, which accepts these credentials and calls <code>done</code> providing a user, as well as <code>options</code> specifying a developer key and callback URL.</p>
<pre><code class="lang-js"><span class="keyword">var</span> FellowshipOneStrategy = <span class="built_in">require</span>(<span class="string">'passport-fellowshipone'</span>).Strategy;

passport.use(<span class="keyword">new</span> FellowshipOneStrategy({
    <span class="attr">apiURL</span>: <span class="string">'https://MyChurch.staging.fellowshiponeapi.com/v1'</span>,
    <span class="attr">consumerKey</span>: F1_DEVELOPER_KEY,
    <span class="attr">consumerSecret</span>: F1_SECRET,
    <span class="attr">callbackURL</span>: <span class="string">"http://127.0.0.1:3000/auth/fellowshipone/callback"</span>
  },
  <span class="function"><span class="keyword">function</span> <span class="title">verify</span>(<span class="params">token, tokenSecret, profile, done</span>) </span>{
    User.findOrCreate({ <span class="attr">userId</span>: profile.id }, <span class="function"><span class="keyword">function</span> (<span class="params">err, user</span>) </span>{
      <span class="keyword">return</span> done(err, user);
    });
  }
));
</code></pre>
<h5 id="f1-specific-options">F1-specific options</h5>
<p>To make life a little easier for dealing with Fellowship One&#39;s API, you can set these options:</p>
<ul>
<li><code>churchCode</code> - Your Fellowship One Church Code. When set, this will be used to automatically build the <code>apiURL</code> option. <em>If you want to use the staging environment, you must also set <code>apiURL</code>!</em></li>
<li><code>apiURL</code> - The base URL for Fellowship One API operations (i.e. <code>https://{churchCode}.staging.fellowshiponeapi.com/v1</code>).
This is auto-calculated from <code>churchCode</code> when not specified, but can be provided here for customizations (i.e. pointing to staging).
Supports <a href="http://tools.ietf.org/html/rfc6570">URI Templating</a>, using the <code>options</code> object to provide properties.</li>
</ul>
<h5 id="the-returned-profile">The returned profile</h5>
<p>The <code>verify</code> callback is given a profile when a user successfully authenticates. The profile is constructed from the user&#39;s <a href="http://developer.fellowshipone.com/docs/v1/People.help">F1 Person</a> record, but only contains a subset of information so that it can be easily linked to a user record in your application.</p>
<p>The profile&#39;s properties are:</p>
<ul>
<li><code>id</code> - (<em>Number</em>) The authenticated user&#39;s numeric ID</li>
<li><code>uri</code> - The full URI for accessing the user&#39;s Person record</li>
<li><code>displayName</code> - A name to be used in user-facing views. If the user has a <code>goesByName</code> set in their F1 Person record, this will be used, otherwise this is the <code>firstName</code> from F1.</li>
<li><code>fullName</code> - The user&#39;s full name (using <code>displayName</code> as the first name)</li>
<li><code>email</code> - A <em>guess</em> at the user&#39;s primary e-mail address. If they <em>have</em> an e-mail address set as <code>preferred</code> in the F1 Person record, this will be it. Otherwise, the first e-mail address found for them is used.</li>
</ul>
<h4 id="authenticate-requests">Authenticate Requests</h4>
<p>Use <code>passport.authenticate()</code>, specifying the <code>&#39;fellowshipone&#39;</code> strategy, to authenticate requests.</p>
<p>For example, as route middleware in an <a href="http://expressjs.com/">Express</a> application:</p>
<pre><code class="lang-js">app.get(<span class="string">'/auth/fellowshipone'</span>,
  passport.authenticate(<span class="string">'fellowshipone'</span>));

app.get(<span class="string">'/auth/fellowshipone/callback'</span>,
  passport.authenticate(<span class="string">'fellowshipone'</span>, { <span class="attr">failureRedirect</span>: <span class="string">'/login'</span> }),
  <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>{
    <span class="comment">// Successful authentication, redirect home.</span>
    res.redirect(<span class="string">'/'</span>);
  });
</code></pre>
<!-- Coming soon!
## Examples

For a complete, working example, refer to the [login example](https://github.com/hairyhenderson/passport-fellowshipone/tree/master/examples/login).
-->
<h2 id="tests">Tests</h2>
<pre><code><span class="meta">$</span><span class="bash"> npm install --dev</span>
<span class="meta">$</span><span class="bash"> make <span class="built_in">test</span></span>
</code></pre><h2 id="credits">Credits</h2>
<ul>
<li><a href="http://github.com/jaredhanson">Jared Hanson</a> - for <a href="http://passportjs.org/">Passport</a> and for <a href="https://github.com/jaredhanson/passport-familysearch">passport-familysearch</a> upon which this module was based.</li>
<li><a href="http://github.com/hairyhenderson">Dave Henderson</a> - for converting passport-familysearch to work with the <a href="http://developer.fellowshipone.com/">Fellowship One API</a></li>
</ul>
<h2 id="license">License</h2>
<p><a href="http://opensource.org/licenses/MIT">The MIT License</a></p>
<p>Copyright (c) 2014-2015 Dave Henderson</p>
</div>
          <div class="metadata">
            <div class="install"><code>npm install <span class="fn">passport-fellowshipone</span></code></div>
            <ul>
              <li><span class="version">0.0.4</span> published <abbr class="updated" title="2015-05-16T02:33:59Z">7 years ago</abbr></li>
              <li><a class="url" href="git://github.com/hairyhenderson/passport-fellowshipone.git">https://github.com/hairyhenderson/passport-fellowshipone</a></li>
            </ul>
            <ul>
              <li><b>0</b> downloads in the last day</li>
              <li><b>0</b> downloads in the last week</li>
              <li><b>3</b> downloads in the last month</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="search-con">
      <div class="head"><span class="close-ico"></span>
        <div class="hold">
          <h2>SEARCH FOR STRATEGIES</h2>
          <form action="/">
            <input value="" type="text" name="strategy" placeholder="Start typing" autocomplete="off">
          </form>
          <p class="info-line"><span>0</span>STRATEGIES</p>
        </div>
      </div>
      <div class="results">
        <section></section>
      </div>
    </div>
    <!--+google-tag-manager-noscript('GTM-M5S3PH')-->
  </body>
</html>